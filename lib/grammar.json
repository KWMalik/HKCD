{   
    "lex": {
        "macros": {
            "Letter": "[a-zA-Z]",
            "Digit" : "[0-9]",
            "NonZeroDigit" : "[1-9]",
        },
        
        "rules": [
            ["/\\*(.|\\n|\\r|\\r\\n)*?\\*/",    "/* skip */"],
            ["//.*",                            "/* skip */"],
            ["\\s+",                            "/* skip */"],
            ["(class|public|static|void|main|String|extends|int|boolean|return|if|else|while|true|new|null|false|this)\\b", "return yytext;"],
            ["System\\.out\\.println\\b",       "return 'printLine';"],
            ["{Letter}({Letter}|{Digit})*",     "return 'ID';"],
            ["({NonZeroDigit}{Digit}*|0)",      "return 'Integer';"],
            ["(\\!=|\\!|-|\\+|\\*|&&|\\/|>=|>|<=|<|==|\\|\\||\\{|\\}|\\[|\\]|\\(|\\)|\\.|;|,|=)", "return yytext;"],
        ]
    },
    
    "operators": [
        ["right", "="],
        ["left", "||"],
        ["left", "&&"],
        ["nonassoc", "==", "!="],
        ["left", "<", "<=", ">", ">="],
        ["left", "+", "-"],
        ["left", "*", "/"],
        ["right", "!", "UMINUS", "."],
    ],

    "bnf": { 
        "Program":          [
                                ["MainClassDecl ClassDeclList", "$$ = new yy.Node('Program', [$1, $2]); return $$;"],
                            ],
        "MainClassDecl":    [
                                ["class ID { public static void main ( String [ ] ID ) { StmtList } }", "$$ = new yy.Node('MainClassDecl', [$2, $12, $15], {'value': $2});"],
                            ],
        "ClassDeclList":    [
                                ["", "$$ = new yy.Node('ClassDeclList');"],
                                ["ClassDecl ClassDeclList", "$2.addChild($1); $$ = $2;"],
                            ],
        "ClassDecl":        [
                                ["class ID Extension { ClassVarDeclList MethodDeclList }", "$$ = new yy.Node('ClassDecl', [$2, $3, $5, $6], {'value', $2});"],
                            ],
        "Extension":        [
                                ["", "$$ = new yy.Node('Extension');"],
                                ["extends ID", "$$ = new yy.Node('Extension', [$2]);"],
                            ],
        "ClassVarDeclList": [
                                ["", "$$ = new yy.Node('ClassVarDeclList');"],
                                ["ClassVarDecl ClassVarDeclList", "$2.addChild($1); $$ = $2;"],
                            ],
        "ClassVarDecl":     [
                                ["Type ID ;", "$$ = new yy.Node('ClassVarDecl', [$2], { 'type' : $2 });"],
                            ],
        "MethodDeclList":   [
                                ["", "$$ = new yy.Node('MethodDeclList');"],
                                ["MethodDecl MethodDeclList", "$2.addChild($1); $$ = $2;"],
                            ],
        "MethodDecl":       [
                                ["public Type ID ( FormalList ) { StmtList return Expr ; }", "$$ = new yy.Node('MethodDecl', [$3, $5, $8, $10], { 'type' : $2 });"],
                            ],
        "FormalList":       [
                                ["", "$$ = new yy.Node('FormalList');"],
                                ["Formal FormalList_", "$2.addChild($1); $$ = $2;"],
                            ],
        "FormalList_":      [
                                ["", "$$ = new yy.Node('FormalList');"],
                                [", Formal FormalList_", "$3.addChild($2); $$ = $3;"],
                            ],
        "Formal":           [
                                ["Type ID", "$$ = new yy.Node('Formal', [$2], { 'type' : $1 });"],
                            ],
        "Type":             [
                                ["int", "$$ = yytext;"],
                                ["boolean", "$$ = yytext;"],
                                ["ID", "$$ = $1;"],
                            ],
        "StmtList":         [
                                ["", "$$ = new yy.Node('StmtList');"],
                                ["Stmt StmtList", "$2.addChild($1); $$ = $2;"],
                            ],
        "Stmt":             [
                                ["Type ID = Expr ;", "$$ = new yy.Node('InitialAssignment', [$2, $4], { 'type' : $1 });"],
                                ["{ StmtList }", "$$ = new yy.Node('Block', [$2]);"],
                                ["if ( Expr ) Stmt else Stmt", "$$ = new yy.Node('If', [$3, $5, $7]);"],
                                ["while ( Expr ) Stmt", "$$ = new yy.Node('While', [$3, $5]);"],
                                ["printLine ( Expr ) ;", "$$ = new yy.Node('PrintLine', [$3]);"],
                                ["ID = Expr ;", "$$ = new yy.Node('Assignment', [$1, $3]);"],
                            ],
        "Expr":             [
                                ["Expr + Expr", "$$ = new yy.Node('Add', [$1, $3]);"],
                                ["Expr - Expr", "$$ = new yy.Node('Subtract', [$1, $3]);"],
                                ["Expr * Expr", "$$ = new yy.Node('Multiply', [$1, $3]);"],
                                ["Expr / Expr", "$$ = new yy.Node('Divide', [$1, $3]);"],
                                ["Expr < Expr", "$$ = new yy.Node('LessThan', [$1, $3]);"],
                                ["Expr <= Expr", "$$ = new yy.Node('LessThanEqual', [$1, $3]);"],
                                ["Expr >= Expr", "$$ = new yy.Node('GreaterThanEqual', [$1, $3]);"],
                                ["Expr > Expr", "$$ = new yy.Node('GreaterThan', [$1, $3]);"],
                                ["Expr == Expr", "$$ = new yy.Node('Equal', [$1, $3]);"],
                                ["Expr != Expr", "$$ = new yy.Node('NotEqual', [$1, $3]);"],
                                ["Expr && Expr", "$$ = new yy.Node('And', [$1, $3]);"],
                                ["Expr || Expr", "$$ = new yy.Node('Or', [$1, $3]);"],
                                ["! Expr", "$$ = new yy.Node('Not', [$2]);"],
                                ["- Expr", "$$ = new yy.Node('Negate', [$2]);", {"prec": "UMINUS"}],
                                ["Expr . ID ( ParameterList )", "$$ = new yy.Node('Call', [$1, $3, $5]);"],
                                ["new ID ( )", "$$ = new yy.Node('Construct', [$2]);"],
                                ["ID", "$$ = yytext;"],
                                ["this", "$$ = yytext;"],
                                ["Integer", "$$ = yytext;"],
                                ["null", "$$ = yytext;"],
                                ["true", "$$ = yytext;"],
                                ["false", "$$ = yytext;"], 
                                ["( Expr )", "$$ = $2;"],
                            ],
        "ParameterList":    [
                                ["", "$$ = new yy.Node('ParameterList');"],
                                ["Expr ParameterList_", "$2.addChild($1); $$ = $2;"],
                            ],
        "ParameterList_":   [
                                ["", "$$ = new yy.Node('ParameterList');"],
                                [", Expr ParameterList_", "$3.addChild($2); $$ = $3;"],
                            ],
    }
}